<!DOCTYPE html>
<html lang="en">
  <%- HEAD() %>
<body>
	
	<%- NAVBAR(false) %>

<div class="main">
    <div class="container">
        <div class="row">
            <%  if(req.data){ %>
            <div class="span4">
            <%- widgetOpen("User: "+ req.data.id ) %>
                <form action="/user/<%- req.data.user.userlogin  %>" method="post" />
        			<h1></h1>		
        			
        			<div class="login-fields">
        				
        				<div class="error" style="color:red;">
        				    <%- error || '' %>
        				</div>
        				
        				
        				<h5>Basic Info</h5>
        				
        				<div class="field">
        					<label for="username">Name:</label>
        					<input type="text" id="username" name="username" value="<%- req.data.user.username  %>" required="required" />
        				</div> <!-- /field -->
        				
        				<hr />
        				
        				<h5>Change Password</h5>
        				<div class="field">
        					<label for="password">Password:</label>
        					<input type="password" id="password" name="password" value="" placeholder="Password" class="login password-field" />
        				</div> <!-- /password -->
        				
        				<div class="field">
        					<label for="password2">Password Check:</label>
        					<input type="password" id="password" name="password2" value="" placeholder="Password Check" class="login password-field" />
        				</div> <!-- /password -->
        				
        				
        				    <% 
        				    var permissionsShown = false;
        				    for(var i in req.data.permissions){  
        				        if(!permissionsShown){
            				        permissionsShown = true; %>
            				        <hr />
            				        <h5>Change Permissions</h5>
            				    <% } %>
        				        <div class="field">
                					<input class="pull-right" type="checkbox" id="permission_<%- i %>" name="permission_<%- i %>" <% if(req.data.user.permissions[i]){%>checked="checked"<%}%> />
                					<label for="permission_<%- i %>"><%- req.data.permissions[i].description %></label>
                				</div> <!-- /password -->
        				    <% } %>
        				    
        				    <% 
        				    var groupsShown = false;
        				    for(var i in req.data.groups){  
        				        if(!groupsShown){
            				        groupsShown = true; %>
            				        <hr />
            				        <h5>Change Permissions</h5>
            				    <% } %>
        				        <div class="field">
                					<input class="pull-right" type="checkbox" id="group_<%- i %>" name="group_<%- i %>" <% if(req.data.user.groups[i].groupname){%>checked="checked"<%}%> />
                					<label for="group_<%- i %>"><%- i %></label>
                				</div> <!-- /password -->
        				    <% } %>
        				<hr />
        				
        			</div> <!-- /login-fields -->
        			
        			<div class="login-actions">
        							
        				<button class="button btn btn-warning btn-large">Save</button>
        				
        			</div> <!-- .actions -->
        			
        			
    	    	</form> 
    		</div>
    		<% } %>
        		
    		<%  if(req.params.id == "new"){ %>
        		<div class="span4">
            
                    <%- widgetOpen("User: "+ req.params.id ) %>
                    <form action="/user/<%- req.params.id  %>" method="post" />
                        <p>Setup Account:</p>
                        <div class="error" style="color:red;">
                            <%- error || '' %>
                        </div>
                        <div class="field">
                            <label for="username">Your Name:</label>
                            <input type="text" id="username" name="username" value="<%- req.body.username || '' %>" placeholder="Your Name" class="login username-field" required="required" />
                        </div>
                        <div class="field">
                            <label for="userlogin">Username:</label>
                            <input type="text" id="userlogin" name="userlogin" value="<%- req.body.userlogin || '' %>" placeholder="Username" class="login username-field" required="required" />
                        </div>
                        <div class="field">
        					<label for="useremail">Email:</label>
        					<input type="text" id="useremail" name="useremail" value="<%- req.body.useremail || '' %>" placeholder="Email" required="required" />
        				</div>
                        <div class="field">
                            <label for="password">Password:</label>
                            <input type="password" id="password" name="password" value="" placeholder="Password" class="login password-field" required="required" />
                        </div>
                        <div class="field">
                            <label for="password2">Password:</label>
                            <input type="password" id="password" name="password2" value="" placeholder="Password Check" class="login password-field" required="required" />
                        </div>
                        <button class="button btn btn-warning pull-right">Setup</button>
                    </form>
                </div>
    		<% } %>
        	<%- widgetClose() %>
        </div>
    </div>
</div>

<script src="/js/libs/jquery-ui-1.10.0.custom.min.js"></script>
<script src="/js/libs/bootstrap.min.js"></script>



</body>
</html>
