<!DOCTYPE html>
<html lang="en">

<%- HEAD() %>

    <body>

        <style>
            .rotate-share-alt:before {
                /* Safari */
                -webkit-transform: rotate(-90deg);
                /* Firefox */
                -moz-transform: rotate(-90deg);
                /* IE */
                -ms-transform: rotate(-90deg);
                /* Opera */
                -o-transform: rotate(-90deg);
                /* Internet Explorer */
                filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
            }
        </style>
        <%- NAVBAR(true) %>

            <div class="main">
                <div class="container">
                    <div class="row">

                        <div class="span12">

                            <div class="widget stacked ">

                                <div class="widget-header">
                                    <% if(editing){ %>
                                    <span class="pull-right"><a href="/doc/<%- $filename %>"><h3>close editor</h3></a></span>
                                    <% }else{ %>
                                    <span class="pull-right"><a href="/doc/<%- $filename %>?edit=true"><h3>open editor</h3></a></span>
                                    <% } %>
                                    
                                    <h3><a href="/doc">Documentation</a></h3>
                                </div>
                                <!-- /widget-header -->
                                <div class="widget-content">
                                    <% if(editing){ %>
                                        <div id="editor"><%- documentation %></div>
                                        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.3/ace.js"></script>
                                        <style type="text/css">
                                            #editor {

                                                height: 800px;
                                            }
                                        </style>
                                        <script>
                                            $(function() {
                                                var $editor = ace.edit("editor");
                                                $editor.setTheme("ace/theme/monokai");
                                                $editor.session.setMode("ace/mode/markdown");
                                                $editor.commands.addCommand({
                                                    name: 'Save',
                                                    bindKey: {win: 'Ctrl-S',  mac: 'Command-S'},
                                                    exec: function(editor) {
                                                        $.post(window.location.pathname, { documentData: $editor.getValue() },function(data) {
                                                            
                                                        });
                                                    },
                                                    readOnly: true // false if this command should not apply in readOnly mode
                                                });
                                                $("#save").click(function() {
                                                    $.post(window.location.pathname, { documentData: $editor.getValue() },function(data) {
                                                        window.location = "/doc/<%- $filename %>";
                                                    });
                                                })
                                            })
                                        </script>
                                        <hr>
                                        <button class="btn" id="save">Save</button>
                                        <% }else{ %>
                                            <%- documentation %>
                                                <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /row -->
                </div>
                <!-- /container -->
            </div>
            <!-- /main -->
            <script src="/js/libs/jquery-ui-1.10.3.custom.min.js"></script>

            <script src="/js/libs/bootstrap.min.js"></script>

    </body>

</html>